# Zellij 使用指南

## 基本概念和术语

### 核心概念
- **会话 (Session)**: Zellij 的顶层容器，可以包含多个标签页
- **标签页 (Tab)**: 会话中的工作区，可以包含多个窗格
- **窗格 (Pane)**: 标签页中的终端实例，可以是平铺或浮动的
- **模式 (Mode)**: Zellij 的操作模式，不同模式有不同的快捷键绑定
- **布局 (Layout)**: 预定义的窗格和标签页排列方式

### 操作模式
- **Normal**: 默认模式，用于基本导航和操作
- **Pane**: 窗格管理模式
- **Tab**: 标签页管理模式
- **Resize**: 调整窗格大小模式
- **Scroll**: 滚动和搜索模式
- **Session**: 会话管理模式
- **Move**: 移动窗格模式
- **Locked**: 锁定模式，防止意外操作

## 基础操作快捷键

### 模式切换
| 快捷键 | 功能描述 | 使用场景 |
|--------|----------|----------|
| `Ctrl + g` | 切换到锁定模式 | 防止意外操作时使用 |
| `Ctrl + p` | 切换到窗格模式 | 管理窗格时使用 |
| `Ctrl + t` | 切换到标签页模式 | 管理标签页时使用 |
| `Ctrl + n` | 切换到调整大小模式 | 调整窗格大小时使用 |
| `Ctrl + s` | 切换到滚动模式 | 查看历史输出时使用 |
| `Ctrl + o` | 切换到会话模式 | 管理会话时使用 |
| `Ctrl + h` | 切换到移动模式 | 移动窗格位置时使用 |
| `Ctrl + b` | 切换到 tmux 兼容模式 | 使用 tmux 风格快捷键时 |
| `Enter` / `Esc` | 返回普通模式 | 从任何模式返回默认模式 |

### 全局快捷键 (在所有模式下可用)
| 快捷键 | 功能描述 | 使用场景 |
|--------|----------|----------|
| `Ctrl + q` | 退出 Zellij | 结束会话时使用 |
| `Alt + n` | 新建窗格 | 快速创建新终端 |
| `Alt + f` | 切换浮动窗格显示/隐藏 | 快速访问浮动窗格 |
| `Alt + h` / `Alt + ←` | 向左移动焦点或切换标签页 | 快速导航 |
| `Alt + l` / `Alt + →` | 向右移动焦点或切换标签页 | 快速导航 |
| `Alt + j` / `Alt + ↓` | 向下移动焦点 | 快速导航 |
| `Alt + k` / `Alt + ↑` | 向上移动焦点 | 快速导航 |
| `Alt + =` / `Alt + +` | 增大窗格大小 | 快速调整窗格 |
| `Alt + -` | 减小窗格大小 | 快速调整窗格 |
| `Alt + i` | 向左移动标签页 | 重新排列标签页 |
| `Alt + o` | 向右移动标签页 | 重新排列标签页 |

## 窗格管理操作

### 窗格模式快捷键 (`Ctrl + p` 进入)
| 快捷键 | 功能描述 | 使用场景 |
|--------|----------|----------|
| `h` / `←` | 移动焦点到左侧窗格 | 窗格间导航 |
| `l` / `→` | 移动焦点到右侧窗格 | 窗格间导航 |
| `j` / `↓` | 移动焦点到下方窗格 | 窗格间导航 |
| `k` / `↑` | 移动焦点到上方窗格 | 窗格间导航 |
| `p` | 切换到下一个窗格 | 循环切换窗格焦点 |
| `n` | 新建窗格 | 在最大可用空间创建窗格 |
| `d` | 向下分割新建窗格 | 水平分割当前窗格 |
| `r` | 向右分割新建窗格 | 垂直分割当前窗格 |
| `s` | 新建堆叠窗格 | 创建堆叠式窗格 |
| `x` | 关闭当前窗格 | 删除不需要的窗格 |
| `f` | 切换窗格全屏 | 专注于单个窗格 |
| `z` | 切换窗格边框显示 | 隐藏/显示窗格边框 |
| `w` | 切换浮动窗格显示 | 管理浮动窗格 |
| `e` | 切换窗格浮动/嵌入状态 | 将窗格在浮动和平铺间切换 |
| `c` | 重命名窗格 | 为窗格设置自定义名称 |
| `i` | 切换窗格固定状态 | 固定/取消固定窗格 |

### 调整大小模式快捷键 (`Ctrl + n` 进入)
| 快捷键 | 功能描述 | 使用场景 |
|--------|----------|----------|
| `h` / `←` | 向左扩展窗格 | 增加窗格宽度 |
| `l` / `→` | 向右扩展窗格 | 增加窗格宽度 |
| `j` / `↓` | 向下扩展窗格 | 增加窗格高度 |
| `k` / `↑` | 向上扩展窗格 | 增加窗格高度 |
| `H` | 向左收缩窗格 | 减少窗格宽度 |
| `L` | 向右收缩窗格 | 减少窗格宽度 |
| `J` | 向下收缩窗格 | 减少窗格高度 |
| `K` | 向上收缩窗格 | 减少窗格高度 |
| `=` / `+` | 自动增大窗格 | 智能调整窗格大小 |
| `-` | 自动减小窗格 | 智能调整窗格大小 |

### 移动窗格模式快捷键 (`Ctrl + h` 进入)
| 快捷键 | 功能描述 | 使用场景 |
|--------|----------|----------|
| `n` / `Tab` | 移动窗格到下一个位置 | 重新排列窗格 |
| `p` | 移动窗格到上一个位置 | 重新排列窗格 |
| `h` / `←` | 向左移动窗格 | 调整窗格位置 |
| `j` / `↓` | 向下移动窗格 | 调整窗格位置 |
| `k` / `↑` | 向上移动窗格 | 调整窗格位置 |
| `l` / `→` | 向右移动窗格 | 调整窗格位置 |

## 标签页管理操作

### 标签页模式快捷键 (`Ctrl + t` 进入)
| 快捷键 | 功能描述 | 使用场景 |
|--------|----------|----------|
| `h` / `←` / `k` / `↑` | 切换到上一个标签页 | 标签页间导航 |
| `l` / `→` / `j` / `↓` | 切换到下一个标签页 | 标签页间导航 |
| `n` | 新建标签页 | 创建新的工作区 |
| `x` | 关闭当前标签页 | 删除不需要的标签页 |
| `r` | 重命名标签页 | 为标签页设置自定义名称 |
| `s` | 切换标签页同步输入 | 同时向所有窗格发送输入 |
| `b` | 将窗格分离到新标签页 | 重新组织工作区 |
| `]` | 将窗格分离到右侧新标签页 | 重新组织工作区 |
| `[` | 将窗格分离到左侧新标签页 | 重新组织工作区 |
| `1`-`9` | 切换到指定编号的标签页 | 快速跳转到特定标签页 |
| `Tab` | 切换到上一个活跃的标签页 | 在两个标签页间快速切换 |

## 滚动和搜索操作

### 滚动模式快捷键 (`Ctrl + s` 进入)
| 快捷键 | 功能描述 | 使用场景 |
|--------|----------|----------|
| `j` / `↓` | 向下滚动一行 | 查看更多输出 |
| `k` / `↑` | 向上滚动一行 | 查看历史输出 |
| `Ctrl + f` / `PageDown` / `l` / `→` | 向下翻页 | 快速浏览输出 |
| `Ctrl + b` / `PageUp` / `h` / `←` | 向上翻页 | 快速浏览输出 |
| `d` | 向下滚动半页 | 中等速度浏览 |
| `u` | 向上滚动半页 | 中等速度浏览 |
| `Ctrl + c` | 滚动到底部并返回普通模式 | 回到最新输出 |
| `s` | 进入搜索模式 | 搜索特定内容 |
| `e` | 用编辑器编辑滚动缓冲区 | 处理大量输出内容 |

### 搜索模式快捷键 (在滚动模式下按 `s` 进入)
| 快捷键 | 功能描述 | 使用场景 |
|--------|----------|----------|
| `n` | 搜索下一个匹配项 | 查找下一个结果 |
| `p` | 搜索上一个匹配项 | 查找上一个结果 |
| `c` | 切换大小写敏感 | 调整搜索选项 |
| `w` | 切换自动换行搜索 | 调整搜索选项 |
| `o` | 切换全词匹配 | 调整搜索选项 |
| `Ctrl + c` | 退出搜索并滚动到底部 | 结束搜索 |

## 会话管理操作

### 会话模式快捷键 (`Ctrl + o` 进入)
| 快捷键 | 功能描述 | 使用场景 |
|--------|----------|----------|
| `d` | 分离会话 | 保持会话在后台运行 |
| `w` | 打开会话管理器 | 管理多个会话 |
| `c` | 打开配置管理器 | 修改 Zellij 配置 |
| `p` | 打开插件管理器 | 管理插件 |
| `a` | 打开关于页面 | 查看版本信息 |
| `s` | 打开分享页面 | 分享会话 |

## 常用配置选项

### 基本配置
```kdl
// 默认 shell
default_shell "zsh"

// 默认工作目录
default_cwd "/home/user/projects"

// 鼠标支持
mouse_mode true

// 窗格边框
pane_frames true

// 自动布局
auto_layout true

// 滚动缓冲区大小
scroll_buffer_size 10000

// 复制到剪贴板
copy_on_select true
```

### 主题配置
```kdl
// 选择主题
theme "default"

// 自定义主题
themes {
    my_theme {
        fg 248 248 242
        bg 40 42 54
        red 255 85 85
        green 80 250 123
        blue 98 114 164
    }
}
```

## 实用技巧和最佳实践

### 1. 快速启动技巧
- 使用 `zellij attach session_name` 连接到现有会话
- 使用 `zellij -s session_name` 创建命名会话
- 使用 `zrf command` 在浮动窗格中运行命令

### 2. 工作流优化
- 为不同项目创建专用会话
- 使用布局文件预定义工作环境
- 利用浮动窗格进行临时任务
- 使用窗格同步功能批量操作

### 3. 导航技巧
- 使用 `Alt + 方向键` 进行快速导航
- 利用标签页编号快速跳转
- 使用 `Tab` 键在最近使用的标签页间切换

### 4. 高效操作
- 学会使用各种模式的专用快捷键
- 利用搜索功能快速定位输出内容
- 使用编辑器功能处理大量日志
- 合理使用窗格分组功能

### 5. 自定义配置
- 根据个人习惯调整快捷键绑定
- 创建自定义主题提升视觉体验
- 配置合适的默认 shell 和工作目录
- 调整滚动缓冲区大小以适应需求

### 6. 故障排除
- 使用 `Ctrl + g` 锁定模式防止意外操作
- 遇到问题时可以使用 `Ctrl + q` 强制退出
- 检查配置文件语法是否正确
- 确保终端支持所需的功能特性
